SELECT DISTINCT r.seq, r.ts, r.id, r.team, r.latitude, r.longitude, r.x, r.y, r.action_id FROM reports r JOIN reports_geometry rg ON r.seq = rg.seq INNER JOIN report_analysis ra ON r.seq = ra.seq LEFT JOIN report_status rs ON r.seq = rs.seq JOIN area_index ai ON ST_Within(rg.geom, ai.geom) WHERE ai.area_id = 6787 AND (rs.status IS NULL OR rs.status = 'active') ORDER BY r.ts DESC LIMIT 1000