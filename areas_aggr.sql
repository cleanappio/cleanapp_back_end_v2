SELECT ai.area_id as area_id, a.name as name, COUNT(CASE WHEN rs.status IS NULL OR rs.status = 'active' THEN r.seq END) as reports_count, COALESCE(AVG(CASE WHEN rs.status IS NULL OR rs.status = 'active' THEN ra.severity_level END), 0.0) as mean_severity, COALESCE(AVG(CASE WHEN rs.status IS NULL OR rs.status = 'active' THEN ra.litter_probability END), 0.0) as mean_litter_probability, COALESCE(AVG(CASE WHEN rs.status IS NULL OR rs.status = 'active' THEN ra.hazard_probability END), 0.0) as mean_hazard_probability FROM area_index ai JOIN areas a ON ai.area_id = a.id LEFT JOIN reports_geometry rg ON ST_Within(rg.geom, ai.geom) LEFT JOIN reports r ON rg.seq = r.seq LEFT JOIN report_analysis ra ON r.seq = ra.seq AND ra.language = 'en' LEFT JOIN report_status rs ON r.seq = rs.seq WHERE ai.area_id IN (6753,6754,6755,6757,6758,6759,6760,6761,6762,6763,6764,6765,6766,6767,6768,6769,6770,6778,6895,6910,6948,6951,6953,6954,6955) GROUP BY ai.area_id ORDER BY ai.area_id;